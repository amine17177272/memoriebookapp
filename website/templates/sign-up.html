{% extends "base.html" %}
{% block
content %}
<link rel="stylesheet" href="../static/sign-up.css">
<form id="SignUpForm" method="POST" action="{{ url_for('auth.sign_up') }}">
    {{ form.hidden_tag() }}
    <div class="ring">
        <i style="--clr:#82a8b3;"></i>
        <i style="--clr:#f6eadc;"></i>
        <i style="--clr:#0d1345;"></i>
        <div class="login">
            <h2>Sign up</h2>
            <div class="form-group">

                <input type="email" class="form-control" id="email" name="email" placeholder="Enter email" />
            </div>
            <div class="form-group">
                <input type="text" class="form-control" id="user_name" name="user_name" placeholder="Enter user name" />
            </div>
            <div class="form-group">
                <input type="password" class="form-control" id="password1" name="password1"
                    placeholder="Enter password" />
            </div>
            <div class="form-group">
                <input type="password" class="form-control" id="password2" name="password2"
                    placeholder="Confirm password" />
            </div>
            <div class="form-group">
                <button type="submit" class="btn btn-primary">Submit</button>
            </div>
            <div class="links">
                <a href="/login">Login</a>
            </div>
        </div>
    </div>
</form>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const form = document.getElementById('SignUpForm');
        form.addEventListener('submit', function (event) {
            event.preventDefault();

            const csrfToken = document.querySelector('input[name=csrf_token]').value;
            const formData = new FormData(form);
            formData.append('csrf_token', csrfToken);

            fetch(form.action, {
                method: form.method,
                body: formData,
                headers: {
                    'X-CSRFToken': csrfToken
                }
            }).then(response => {
                return response.text();
            }).then(data => {
                console.log(data);
                // Handle success or error
            }).then((_res) => {
                window.location.href = "/";
            });
        });

    });
</script>

{% endblock %}